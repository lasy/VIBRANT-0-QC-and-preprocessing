"0",""
"0","tmp <- "
"0","  raw |> "
"0","  as_tibble() |> "
"0","  group_by(sample_id, .feature) |> "
"0","  mutate(n = n()) |> "
"0","  ungroup() |> "
"0","  filter(n > 1, !is.na(conc_log2))"
"0",""
"0","tmp <- "
"0","  left_join("
"0","    tmp |> "
"0","      select(.feature, .sample, sample_id, sample_type, plate_nb, conc_log2) |> "
"0","      dplyr::rename(.sample_r1 = .sample, plate_nb_r1 = plate_nb, conc_log2_r1 = conc_log2),"
"0","    tmp |> "
"0","      select(.feature, .sample, sample_id, plate_nb, conc_log2) |> "
"0","      dplyr::rename(.sample_r2 = .sample, plate_nb_r2 = plate_nb, conc_log2_r2 = conc_log2),"
"0","    by = join_by(.feature, sample_id),"
"0","    relationship = ""many-to-many"""
"0","  ) |> "
"0","  filter(.sample_r1 != .sample_r2)"
"0",""
