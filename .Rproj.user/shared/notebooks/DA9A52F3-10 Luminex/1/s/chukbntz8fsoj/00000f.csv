"0",""
"0",""
"0","samples_to_rerun_OOR <- "
"0","  colData(raw) |>"
"0","  as.data.frame() |>"
"0","  rownames_to_column("".sample"") |>"
"0","  as_tibble() |> "
"0","  filter(sample_type == ""Sample"", n_OOR > 12) |> "
"0","  select(.sample, plate_nb, plate_row, plate_col, sample_id) |> "
"0","  mutate(reason = ""many OOR values"")"
"0",""
"0",""
"0","samples_with_large_differences_between_across_plate_replicates <- "
"0","  raw |> "
"0","  as_tibble() |> "
"0","  filter(sample_type == ""Sample"") |> "
"0","  group_by(sample_id) |>"
"0","  mutate("
"0","    n_samples = length(unique(.sample)),"
"0","    n_plates = length(unique(plate_nb))"
"0","    ) |> "
"0","  ungroup() |> "
"0","  filter(n_samples >= 2) |> "
"0","  group_by(sample_id, n_plates, .feature) |>"
"0","  summarize("
"0","    max_n_OOR = max(n_OOR),"
"0","    log2_conc_diff_sq = sum((conc_log2 - mean(conc_log2))^2),"
"0","    .groups = ""drop"""
"0","  ) |> "
"0","  group_by(sample_id, max_n_OOR, n_plates) |>"
"0","  summarize(log2_conc_diff_sq = sum(log2_conc_diff_sq), .groups = ""drop"") "
"0",""
"0","samples_with_large_differences_between_across_plate_replicates |> "
"0","  ggplot() +"
"0","  aes(x = log2_conc_diff_sq, fill = max_n_OOR > 5 ) +"
"0","  geom_histogram()"
"0",""
