"0",""
"0","plot_pca_scores <- function(pca_res, raw, axes = 1:2, col_by = ""sample_type""){"
"0","  scores <- "
"0","    colData(raw) |> "
"0","    as.data.frame() |> "
"0","    rownames_to_column("".sample"") |> "
"0","    as_tibble() |> "
"0","    left_join("
"0","      as_tibble(pca_res$x) |> "
"0","        mutate(.sample = rownames(pca_res$x)),"
"0","      by = join_by(.sample)"
"0","    )"
"0","  "
"0","  var <- factoextra::get_eig(pca_res)"
"0","  "
"0","  xvar <- str_c(""PC"", axes[1])"
"0","  yvar <- str_c(""PC"", axes[2])"
"0","  ggplot(scores) +"
"0","    aes(x = .data[[xvar]], y = .data[[yvar]], col = .data[[col_by]]) +"
"0","    geom_vline(xintercept = 0, col = ""gray"") +"
"0","    geom_hline(yintercept = 0, col = ""gray"") +"
"0","    geom_point(alpha = 0.8) +"
"0","    labs("
"0","      x = str_c(xvar, "" ("", var$variance.percent[axes[1]] |> round(1), ""%)""), "
"0","      y = str_c(yvar, "" ("", var$variance.percent[axes[2]] |> round(1), ""%)"")"
"0","      ) +"
"0","    coord_fixed()"
"0","}"
"0",""
